#easy #web #burpsuite 

# Cookies Walkthrough

<img width="765" alt="cookies - dash" src="https://github.com/user-attachments/assets/a071b954-d401-4409-a24b-825e0c66edab" />


The link takes us to a simple webpage with a search bar and this message:
“Welcome to my cookie search page. See how much I like different kinds of cookies!”

<img width="616" alt="cookies - site" src="https://github.com/user-attachments/assets/6cb63d24-576a-413e-92a4-d45c2108fe3b" />


### Initial Exploration


The first thing I tried was entering the suggested word, **“snickerdoodle”**, into the search bar. The response was:

<img width="569" alt="cookies - correct guess" src="https://github.com/user-attachments/assets/9ec94136-38fa-456c-96a0-da451545f950" />


This seemed to indicate that the input was valid but didn’t lead to anything significant.
Next, I tried entering **“test”**, and the response was:

<img width="572" alt="cookies - incorrect guess" src="https://github.com/user-attachments/assets/f11270d2-f5b2-462c-9617-ad1779da16bc" />


It appeared the site only accepted names of actual cookies, which limited the input options.


### Diving Deeper


With no further hints and limited knowledge of American cookie names, I decided to analyze the site’s behavior using **Burp Suite**.

(For a detailed setup guide to Burp Suite, refer to the [IntroToBurp walkthrough](PicoCTF/Easy/Web-Exploitation/IntroToBurp.md).)


**Burp Suite Analysis**

Once the site was added to Burp’s **Scope**, I repeated the previous attempts using “snickerdoodle” and “test” to observe the HTTP requests.

<img width="1252" alt="cookies - burp history" src="https://github.com/user-attachments/assets/e9fc1890-f139-4bed-b9a1-6c254550694e" />


**Observations**

1. The site performed **two redirects**:
	- **/search** – handled the initial input.
	- **/check** – evaluated the cookie value.

2. A cookie named name was set:
	- The value was -1 when no valid input was provided.
	- A **positive number** was assigned for valid cookie names like “snickerdoodle.”


### Brute Force


Since I didn’t know every cookie name in the world, I decided to brute force the cookie values using Burp’s **Intruder** tool.


**Steps**

1. **Send the /check request to Intruder:**
	- Right-click the request and select _Send to Intruder_.

<img width="1512" alt="cookies - burp send intruder" src="https://github.com/user-attachments/assets/788aa588-ca71-4e50-a7df-23df028e4d3a" />


2. **Set the Payload Position:**
	- Highlight the value of the cookie name and mark it as the payload position.

<img width="1512" alt="cookies - set payload" src="https://github.com/user-attachments/assets/818bf945-cfbb-46fc-8956-8ae7515af0b1" />


3. **Configure the Payload Type:**
	- Select **Numbers** as the payload type.
	- Set the range from **-1 to 50** (based on initial observations).

<img width="1512" alt="cookies - set numbers payoad" src="https://github.com/user-attachments/assets/2ec74244-fc80-4a07-81f5-e436f473cdd6" />


4. **Start the Attack:**
	- Launch the attack. Burp Suite sent each request with a different cookie value within the specified range.

  
**Analyzing the Results**

After a few minutes, Burp completed the attack and displayed all the responses.


### Flag

Manually reviewing each response would have been tedious, so I used Burp’s **Grep** feature:

1. In the right-hand **Options** pane, enable the **Grep Match** feature.
2. Add the keyword picoCTF{ as the search term.

Burp quickly highlighted the response containing the flag. Success!

<img width="1512" alt="cookies - grep match flag" src="https://github.com/user-attachments/assets/a2de6811-4054-4947-bb70-995db7e27d24" />


**Conclusion**

This challenge demonstrated the importance of understanding how cookies are used and the potential for vulnerabilities in how values are processed.

- **Cookies and Input Validation:** Always validate user input and handle cookies securely to prevent brute-force attacks.
- **Burp Suite:** An essential tool for web application testing, allowing detailed analysis and manipulation of HTTP requests.

See you in the next challenge!
