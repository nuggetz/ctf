#easy #web 

# logon Walkthrough

<img width="492" alt="logon - dash" src="https://github.com/user-attachments/assets/24eeca34-0e6f-4eb8-a45a-0ddf477ef9f0" />


This challenge hints at a hidden privilege escalation mechanism, likely tied to the “Joe” user account.


### Step 1: Logging in as Joe

<img width="567" alt="logon - site" src="https://github.com/user-attachments/assets/a77641cd-b1ee-4fb3-8945-f4559b2d06be" />


Upon visiting the provided link, we’re greeted by a login page. Based on the challenge description, I tried logging in with:

- **Username:** joe
- **Password:** (left blank)

The login succeeded, confirming access to the site as “Joe”. However, no flag was presented after logging in.

<img width="585" alt="logon - try log joe" src="https://github.com/user-attachments/assets/34e8c385-5b8b-4b3a-8dc3-8025446cfe2f" />


### Step 2: Analyzing the Site

Since the flag wasn’t immediately visible, I decided to inspect the site further using the browser developer tools.

Within the **Application tab** of the browser’s developer tools, I checked the stored cookies and noticed the following entry:

<img width="477" alt="logon - cookie editor" src="https://github.com/user-attachments/assets/3d952a03-493f-4726-93a0-11e1e32447c1" />


This cookie parameter indicates that the user is currently logged in as a non-admin account, which might be why the flag isn’t accessible.


### Step 3: Exploiting the Cookie

Cookies are small pieces of data stored on the client side that websites use to keep track of user sessions. The presence of Admin=False suggested the site might be using this cookie to determine the user’s privilege level.

To test this, I edited the cookie value:

<img width="119" alt="logon - cookie editor admin" src="https://github.com/user-attachments/assets/bbc65e0e-f9ed-4375-9585-6a4e07f7464c" />


After modifying the cookie, I refreshed the page.


### Step 4: Success!

Upon reloading the site, the flag appeared. Changing the cookie value granted administrative privileges, allowing access to hidden content that wasn’t available to standard users.

<img width="593" alt="logon - flag" src="https://github.com/user-attachments/assets/a47a9b30-0e18-4754-97d2-f93a33f5a59a" />
  

> [!NOTE]
> **Why Did This Work?**
> 
> This vulnerability exists because the website relies on **client-side cookies** to manage user permissions. This approach is insecure because:
> 
> 1. **Cookies are editable by users:**
> Anyone with access to browser developer tools can inspect and modify cookie values.
> 
> 2. **No server-side validation:**
> The server should validate user permissions based on its internal database, not rely solely on cookies sent by the client.


### Secure Implementation Recommendations:

To prevent this type of vulnerability:
- **Use server-side permission checks:**
	Always verify a user’s privilege level on the server rather than trusting data from the client side.

- **Sign and encrypt cookies:**
	Use techniques like HMAC (Hash-based Message Authentication Code) to ensure the integrity of cookie values. This prevents unauthorized modifications.


This challenge demonstrates the importance of securely managing user permissions. Developers must ensure sensitive operations are validated on the server side to prevent privilege escalation attacks like this one.

See you in the next challenge! 🎉
